# Database connection
DATABASE_URL=postgresql://username:password@localhost:5432/bugspotter

# Server configuration
PORT=3000
NODE_ENV=development

# JWT Secret (generate with: openssl rand -base64 32)
JWT_SECRET=your-secret-key-here

# Optional: Database connection pool settings
DB_POOL_MIN=2
DB_POOL_MAX=10
DB_CONNECTION_TIMEOUT_MS=30000
DB_IDLE_TIMEOUT_MS=30000
DB_RETRY_ATTEMPTS=3
DB_RETRY_DELAY_MS=1000

# Optional: API rate limiting (1 minute window, 100 requests per minute)
RATE_LIMIT_WINDOW_MS=60000
RATE_LIMIT_MAX_REQUESTS=100

# CORS Configuration (comma-separated list of allowed origins)
CORS_ORIGINS=http://localhost:3000,http://localhost:5173

# JWT Token Expiration
JWT_EXPIRES_IN=24h
JWT_REFRESH_EXPIRES_IN=7d

# File Upload Limits (in bytes, default 10MB)
MAX_UPLOAD_SIZE=10485760

# Logging Level (debug, info, warn, error)
LOG_LEVEL=info

# ===================================
# Retention Policy Configuration
# ===================================

# Default retention periods (days)
DEFAULT_RETENTION_DAYS=90
SCREENSHOT_RETENTION_DAYS=60
REPLAY_RETENTION_DAYS=30
ATTACHMENT_RETENTION_DAYS=90
ARCHIVED_RETENTION_DAYS=365

# Compliance region: none, eu, us, kz, uk, ca
# Determines regulatory requirements (GDPR, SOX, Kazakhstan law, etc.)
COMPLIANCE_REGION=none

# Retention scheduler (cron format)
RETENTION_CRON_SCHEDULE="0 2 * * *"       # Daily at 2 AM
RETENTION_CRON_TIMEZONE="UTC"             # Timezone for scheduled jobs
RETENTION_SCHEDULER_ENABLED=true

# ===================================
# Storage Configuration
# ===================================

# Storage backend: local, s3, minio, or r2
STORAGE_BACKEND=local

# Local Storage (for development/testing)
STORAGE_BASE_DIR=./data/uploads
STORAGE_BASE_URL=http://localhost:3000/uploads

# S3-Compatible Storage (AWS S3, MinIO, Cloudflare R2)
# Uncomment and configure when using S3-compatible storage

# S3_ENDPOINT=                    # Optional: for MinIO/R2 (e.g., http://localhost:9000)
# S3_REGION=us-east-1            # AWS region or MinIO region
# S3_ACCESS_KEY=                  # AWS Access Key ID or MinIO access key
# S3_SECRET_KEY=                  # AWS Secret Access Key or MinIO secret key
# S3_BUCKET=bugspotter           # Bucket name
# S3_FORCE_PATH_STYLE=true       # Required for MinIO (false for AWS S3)
# S3_MAX_RETRIES=3               # Number of retry attempts
# S3_TIMEOUT_MS=30000            # Request timeout in milliseconds

# Example MinIO Configuration:
# STORAGE_BACKEND=minio
# S3_ENDPOINT=http://localhost:9000
# S3_REGION=us-east-1
# S3_ACCESS_KEY=minioadmin
# S3_SECRET_KEY=minioadmin
# S3_BUCKET=bugspotter
# S3_FORCE_PATH_STYLE=true

# Example AWS S3 Configuration:
# STORAGE_BACKEND=s3
# S3_REGION=us-east-1
# S3_ACCESS_KEY=AKIAIOSFODNN7EXAMPLE
# S3_SECRET_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY
# S3_BUCKET=bugspotter-prod

# Example Cloudflare R2 Configuration:
# STORAGE_BACKEND=r2
# S3_ENDPOINT=https://account-id.r2.cloudflarestorage.com
# S3_REGION=auto
# S3_ACCESS_KEY=your-r2-access-key
# S3_SECRET_KEY=your-r2-secret-key
# S3_BUCKET=bugspotter

# ===================================
# Job Queue Configuration (BullMQ)
# ===================================

# Redis Configuration
REDIS_URL=redis://localhost:6379
REDIS_MAX_RETRIES=3
REDIS_RETRY_DELAY=1000

# Worker Configuration (enable/disable specific workers)
WORKER_SCREENSHOT_ENABLED=true
WORKER_REPLAY_ENABLED=true
WORKER_INTEGRATION_ENABLED=true
WORKER_NOTIFICATION_ENABLED=true

# Worker Concurrency (number of parallel jobs)
WORKER_SCREENSHOT_CONCURRENCY=5
WORKER_REPLAY_CONCURRENCY=3
WORKER_INTEGRATION_CONCURRENCY=10
WORKER_NOTIFICATION_CONCURRENCY=5

# Job Configuration
JOB_RETENTION_DAYS=7              # How long to keep completed jobs
MAX_JOB_RETRIES=3                 # Max retry attempts for failed jobs
BACKOFF_DELAY=5000                # Initial backoff delay in ms
JOB_TIMEOUT=300000                # Job timeout in ms (5 minutes)

# Processing Configuration
REPLAY_CHUNK_DURATION=30          # Replay chunk duration in seconds
MAX_REPLAY_SIZE_MB=100            # Max replay size before chunking
THUMBNAIL_WIDTH=320               # Thumbnail width in pixels
THUMBNAIL_HEIGHT=240              # Thumbnail height in pixels
SCREENSHOT_QUALITY=85             # JPEG quality (1-100)
