<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>BugSpotter Demo - Test All Capture Features</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/rrweb-player@latest/dist/style.css" crossorigin="anonymous" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div class="container">
      <div class="header">
        <h1>BugSpotter SDK Demo</h1>
        <p>Interactive showcase of all SDK features with tabbed navigation</p>
      </div>

      <!-- Tab Navigation -->
      <div class="tabs">
        <button class="tab active" onclick="switchTab('capture')">
          <span class="tab-icon">üì∏</span>
          <span>Capture</span>
          <span class="tab-count">4</span>
        </button>
        <button class="tab" onclick="switchTab('replay')">
          <span class="tab-icon">üé•</span>
          <span>Replay</span>
        </button>
        <button class="tab" onclick="switchTab('security')">
          <span class="tab-icon">üîí</span>
          <span>Security</span>
          <span class="tab-count">3</span>
        </button>
        <button class="tab" onclick="switchTab('advanced')">
          <span class="tab-icon">‚öôÔ∏è</span>
          <span>Advanced</span>
          <span class="tab-count">2</span>
        </button>
        <button class="tab" onclick="switchTab('ui')">
          <span class="tab-icon">üé®</span>
          <span>UI Components</span>
          <span class="tab-count">2</span>
        </button>
      </div>

      <!-- Tab 1: Capture Features -->
      <div id="tab-capture" class="tab-content active">
        <!-- Console Logging Section -->
        <div class="section">
          <h2>Console Data <span class="badge">Test Console Capture</span></h2>
          <p>Generate console entries to test logging capture functionality.</p>
          <div class="button-grid">
            <button class="btn-info" onclick="testConsoleLog()">console.log</button>
            <button class="btn-warning" onclick="testConsoleWarn()">console.warn</button>
            <button class="btn-danger" onclick="testConsoleError()">console.error</button>
            <button class="btn-success" onclick="testConsoleInfo()">console.info</button>
          </div>
        </div>

        <!-- Network Requests Section -->
        <div class="section">
          <h2>Network Activity <span class="badge">Test Network Capture</span></h2>
          <p>Test network request capture with various API endpoints.</p>
          <div class="button-grid">
            <button class="btn-success" onclick="testSuccessfulRequest()">
              Successful API Call
            </button>
            <button class="btn-danger" onclick="testFailedRequest()">Failed API Call</button>
            <button class="btn-info" onclick="testMultipleRequests()">Multiple Requests</button>
            <button class="btn-warning" onclick="testXHRRequest()">XHR Request</button>
          </div>
        </div>

        <!-- Screenshot Section -->
        <div class="section">
          <h2>Visual Capture <span class="badge">Auto-captured</span></h2>
          <p>Screen content is automatically captured when generating a report.</p>
          <div class="test-element" id="screenshot-test">
            <strong>üé® This content will be captured in the screenshot!</strong>
            <p>ID: screenshot-test-element-${Date.now()}</p>
          </div>
        </div>

        <!-- Metadata Section -->
        <div class="section">
          <h2>System Information <span class="badge">Auto-captured</span></h2>
          <p>Environment details including browser, viewport, operating system, and timestamps are automatically collected.</p>
          <div class="button-grid">
            <button class="btn-info" onclick="showCurrentMetadata()">Show Current Metadata</button>
          </div>
        </div>

        <!-- Main Capture Button -->
        <div class="section">
          <h2>Generate Report</h2>
          <p>
            Use the floating capture button (bottom-right) or the button below to collect all data:
            console entries, network activity, visual capture, and system information.
          </p>
          <div class="button-grid">
            <button class="btn-capture" onclick="captureBugReport()">üì∏ Generate Full Bug Report</button>
          </div>
        </div>

        <!-- Output Section -->
        <div id="output"></div>
      </div>

      <!-- Tab 2: Session Replay -->
      <div id="tab-replay" class="tab-content">
        <div class="section">
          <h2>üé• Session Replay <span class="badge">30-Second Buffer</span></h2>
          <p>
            Your interactions are continuously recorded in a 30-second circular buffer. DOM changes, clicks, scrolls, and mouse movements are captured automatically. Play back your session below!
          </p>
          
          <h3>üì• Replay Submitted Reports</h3>
          <p style="color: #64748b; font-size: 0.9rem;">
            Fetch and replay session recordings from previously submitted bug reports.
          </p>
          <div class="button-grid">
            <button class="btn-primary" onclick="fetchBugReports()">üìã Fetch Bug Reports</button>
            <button class="btn-success" onclick="replayLatestReport()">‚ñ∂Ô∏è Replay Latest Report</button>
          </div>
          <div id="bug-reports-list" style="margin-top: 1rem;"></div>

          <hr style="margin: 2rem 0; border: none; border-top: 1px solid #e2e8f0;">

          <h3>üìπ Live Session Recording</h3>
          <p style="color: #64748b; font-size: 0.9rem;">
            Record your current session and play it back immediately.
          </p>
          <div class="button-grid">
            <button class="btn-primary" onclick="playReplay()">‚ñ∂Ô∏è Play Current Session</button>
            <button class="btn-info" onclick="showReplayInfo()">üìä Show Replay Info</button>
            <button class="btn-success" onclick="testInteraction()">‚ú® Test Interaction</button>
            <button class="btn-warning" onclick="stopReplay()">‚èπÔ∏è Stop Replay</button>
          </div>
          <div id="replay-info" style="display: none; margin-top: 1rem; padding: 1rem; background: white; border: 1px solid #e2e8f0; border-radius: 4px; font-size: 0.9rem;"></div>
          
          <!-- Replay Player -->
          <div id="replay-player-container">
            <div class="player-header">
              <h3>üìπ Session Replay Player</h3>
              <div class="player-stats" id="player-stats">Ready to play</div>
            </div>
            <div id="replay-player"></div>
            <div class="player-controls">
              <button class="btn-success" onclick="replayPlayer && replayPlayer.play()">‚ñ∂Ô∏è Play</button>
              <button class="btn-warning" onclick="replayPlayer && replayPlayer.pause()">‚è∏Ô∏è Pause</button>
              <button class="btn-info" onclick="replayPlayer && replayPlayer.setSpeed(2)">2x Speed</button>
              <button class="btn-info" onclick="replayPlayer && replayPlayer.setSpeed(1)">1x Speed</button>
              <button class="btn-danger" onclick="stopReplay()">‚èπÔ∏è Close</button>
            </div>
          </div>
        </div>
      </div>

      <!-- Tab 3: Security & Privacy -->
      <div id="tab-security" class="tab-content">
        <!-- PII Sanitization Section -->
        <div class="section">
          <h2>üîí Data Sanitization <span class="badge">Privacy & Security</span></h2>
          <p>Test automatic detection and sanitization of PII (Personally Identifiable Information) and sensitive credentials.</p>
          <div class="test-element" id="pii-test-area" style="text-align: left; font-family: monospace; font-size: 0.9rem; line-height: 1.6;">
            <strong>Sample Sensitive Data:</strong><br>
            <em style="color: #718096;">PII (Personal Info):</em><br>
            Email: john.doe@example.com<br>
            Phone: (555) 123-4567<br>
            Credit Card: 4532-1234-5678-9010<br>
            SSN: 123-45-6789<br>
            <br>
            <em style="color: #718096;">Credentials (Secrets):</em><br>
            API Key: sk_live_abc123def456ghi789<br>
            Token: ghp_1234567890abcdefghijklmnopqrstuv<br>
            Password: MySecureP@ss123<br>
          </div>
          <div class="button-grid">
            <button class="btn-primary" onclick="testPIISanitization()">Test Data Sanitization</button>
            <button class="btn-info" onclick="testPIIInConsole()">Log Sensitive Data</button>
            <button class="btn-success" onclick="showSanitizedData()">Show Before/After</button>
          </div>
          <div id="pii-output" style="display: none; margin-top: 1rem; padding: 1rem; background: white; border: 1px solid #48bb78; border-radius: 4px; font-size: 0.9rem; font-family: monospace;"></div>
        </div>
      </div>

      <!-- Tab 4: Advanced Features -->
      <div id="tab-advanced" class="tab-content">
        <!-- Authentication Demo Section -->
        <div class="section">
          <h2>üîê Authentication Flexibility <span class="badge">Multiple Auth Methods</span></h2>
          <p>
            BugSpotter supports multiple authentication methods: API Key, Bearer Token with auto-refresh, and OAuth. 
            Switch between auth methods and test token refresh on 401 errors!
          </p>
          <div class="button-grid">
            <button class="btn-primary" onclick="switchToApiKey()">Use API Key Auth</button>
            <button class="btn-success" onclick="switchToBearerToken()">Use Bearer Token</button>
            <button class="btn-info" onclick="switchToOAuth()">Use OAuth</button>
            <button class="btn-warning" onclick="testTokenRefresh()">Test Token Refresh</button>
            <button class="btn-danger" onclick="showAuthConfig()">Show Current Auth</button>
          </div>
          <div id="auth-output" style="display: none; margin-top: 1rem; padding: 1rem; background: white; border: 1px solid #3182ce; border-radius: 4px; font-family: monospace; font-size: 0.9rem;"></div>
        </div>

        <!-- Compression Demo Section -->
        <div class="section">
          <h2>üì¶ Gzip Compression <span class="badge">70-90% Reduction</span></h2>
          <p>
            Bug reports are automatically compressed using gzip before sending to the server. 
            Screenshots are optimized to WebP format and resized. Test the compression below to see real-time size reduction!
          </p>
          <div class="button-grid">
            <button class="btn-primary" onclick="testCompression()">Test Compression</button>
            <button class="btn-success" onclick="testLargePayload()">Generate Large Payload</button>
            <button class="btn-info" onclick="showCompressionInfo()">Show Compression Stats</button>
          </div>
          <div id="compression-output" style="display: none; margin-top: 1rem; padding: 1rem; background: white; border: 1px solid #3182ce; border-radius: 4px;"></div>
        </div>
      </div>

      <!-- Tab 5: UI Components -->
      <div id="tab-ui" class="tab-content">
        <!-- Floating Button Widget Section -->
        <div class="section">
          <h2>üéà Floating Button Widget <span class="badge">Customizable</span></h2>
          <p>
            The floating bug button appears in the bottom-right corner. Click it to capture a bug
            report! You can also test the widget configuration options below.
          </p>
          <div class="button-grid">
            <button class="btn-info" onclick="showFloatingButton()">Show Button</button>
            <button class="btn-warning" onclick="hideFloatingButton()">Hide Button</button>
            <button class="btn-success" onclick="changeButtonIcon()">Change Icon</button>
            <button class="btn-danger" onclick="changeButtonColor()">Change Color</button>
          </div>
        </div>

        <!-- Bug Report Modal Demo Section -->
        <div class="section">
          <h2>ü™ü Bug Report Modal <span class="badge">UI Demo</span></h2>
          <p>
            Click below to open the Bug Report Modal directly, with a sample screenshot preview. Submitting the form will display the bug data below.
          </p>
          <div class="button-grid">
            <button class="btn-primary" onclick="showBugReportModalDemo()">Show Bug Report Modal</button>
          </div>
        </div>
      </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/rrweb-player@latest/dist/index.js"></script>
    <script src="bugspotter.min.js"></script>
    <script src="demo.js"></script>
  </body>
</html>
